<!--// 사용하기 쉽고 한번의 호출로 해결하기 위해 여러번 사용되는건 미리 셋팅 -->
<!--// display_file_list = (A=모두, I=이미지, M=미디어, B=바이너리) -->
{@
    $oDocument = $oBodex->getWith($oDocument, array('category_srl','readed_count','voted_count','member_srl','blamed_count','reward_srl','reward_point','comment_count','is_notice'));
    $oDocument->reward_point=round($oDocument->reward_point/2);

    $oDocument->title=$oDocument->getTitle();
    $oDocument->permanentUrl=$oDocument->getPermanentUrl();
    $oDocument->member_srl = $oDocument->getMemberSrl();
    $oDocument->nickName = $oDocument->getNickName();
    $oDocument->nickName = ($oDocument->nickName=='anonymous'?$lang->anonymous:$oDocument->nickName);
    $oDocument->member_srl = (!$grant->manager && $oDocument->member_srl && $oDocument->get('user_id')=='anonymous')?0:$oDocument->member_srl;

    $oDocument->profileImage = $oDocument->getProfileImage();
    $oDocument->signature = $oDocument->getSignature();

    $is_document_secret = ($oDocument->isSecret() && !$oDocument->isGranted());

    $is_display_image = (!$module_info->display_file_list || $module_info->display_file_list=='A'||$module_info->display_file_list=='I'||$module_info->display_file_list=='BI'||$module_info->display_file_list=='MI');
    $is_display_media = (!$module_info->display_file_list || $module_info->display_file_list=='A'||$module_info->display_file_list=='M'||$module_info->display_file_list=='BM'||$module_info->display_file_list=='MI');
    $is_display_binary = (!$module_info->display_file_list || $module_info->display_file_list=='A'||$module_info->display_file_list=='B'||$module_info->display_file_list=='BM'||$module_info->display_file_list=='BI');

    $adopted_reward_point = ($module_info->use_reward != 'N' && $oDocument->reward_point > 0)?$oDocument->reward_point:0;
    $download_file_point = abs($oBodex->getPointConfig('download_file'));
    $extra_key_list = $writer_rating_list = $writer_display_ccl = $writer_appoint_ids = array();
}

<!--// 공지사항은 권한부여 -->
<!--@if($oDocument->isNotice())-->{@ $grant->view = true}<!--@endif-->

<!--// 추천 정보를 가져옴, 로그인된 멤버가 있으면 값을 가져와 없으면 아직 투표하지 않음, 필수일 경우 로그인 유저만 댓글 허용 -->
<!--@if($module_info->use_vote != 'N')-->
    {@
        $oDocument->voted_list = $oBodex->getVotedLogInfo($oDocument->document_srl);
        $logged_user_voted_star = $oDocument->voted_list[$logged_info->member_srl];
    }
    <!--@if(!$is_logged && ($module_info->use_vote == 'R' || $module_info->use_vote == 'Z'))-->
        {@ $grant->write_comment = false}
    <!--@endif-->
<!--@endif-->

<!--@foreach($oDocument->getExtraVars() as $key => $val)-->
    <!--@if(substr($val->eid,0,13) == 'writer_rating')-->
        {@ $writer_rating_list[$key] = $val}
    <!--@elseif($val->eid=='writer_display_ccl')-->
        {@ $writer_display_ccl = explode('|@|',$val->value)}
    <!--@else-->
        <!--@if($val->eid=='writer_appoint_view' && $val->value)-->
            {@
                $writer_appoint_ids = ($val->value)?explode(',',str_replace('|@|',',',$val->value)):null;
                $is_document_secret = (!$grant->manager && !$oDocument->isGranted() && count($writer_appoint_ids))?true:$is_document_secret;
            }
        <!--@endif-->
        {@ $extra_key_list[$key] = $val}
    <!--@endif-->
<!--@endforeach-->

<!--// 보기 유저 지정시 권한이 없으면 보기 권한 해제 -->
<!--@if($logged_info && count($writer_appoint_ids))-->
    <!--@if(!in_array($logged_info->user_id, $writer_appoint_ids))-->
        <!--@foreach($logged_info->group_list as $key => $val)-->
            <!--@if(in_array('#'.$key, $writer_appoint_ids)){
                $is_document_secret = false;
                break;
            }--><!--@endif-->
        <!--@endforeach-->
    <!--@else-->
        {@ $is_document_secret = false}
    <!--@endif-->
<!--@endif-->

<!--// 보기 권한이 없으면 정보 지움 -->
<!--@if(!$grant->view || $is_document_secret)-->
    {@
        $oDocument->add('content',sprintf($lang->msg_act_not_permitted,$lang->col_read));
        $oDocument->add('allow_comment','N');
        $file_list = $extra_key_list = array();
    }
<!--@elseif($oDocument->hasUploadedFiles() && !$is_document_secret)-->
    {@
        $file_list = $oBodex->getSplitFileList($oDocument->getUploadedFiles());
        $downloaded_list = ($module_info->use_down_point_always=='Y') ? array():$oBodex->getDownloadedLogInfo($oDocument->document_srl);
    }
<!--@endif-->

<!--@if($logged_info && $logged_info->member_srl == $oDocument->member_srl && $module_info->login_nickname_color)-->{@ $_tmp_nick_color = ' style="color:'.$module_info->login_nickname_color.'"'}<!--@else-->{@ $_tmp_nick_color = ''}<!--@endif-->


<!--// 글 내용 보여주기 -->
<div class="bodexRead">
    <div class="originalContent">

        <div class="readHeader">
            <div class="titleAndUser">

                <!--// 블러그 형태 일때 관리자일 경우 게시글 선택 checkbox 표시 -->
                <div class="title<!--@if($blog_style_doc_no && $grant->manager)--> checkbox<!--@endif-->">
                    <h4>
                        <!--@if($blog_style_doc_no && $grant->manager)-->
                            <input type="checkbox" name="cart" value="{$oDocument->document_srl}" onclick="doAddDocumentCart(this)" {$oDocument->isCarted()?'checked="checked"':''} />
                        <!--@else-->
                            <img src="./images/common/icon2Check.gif" border="0" alt="" />
                        <!--@endif-->
                        <a href="{$oDocument->permanentUrl}">{$oDocument->title}</a>
                    </h4>
                </div>

                <!--@if($module_info->display_author!='N')-->
                    <div class="userInfo">
                        <div class="author">
                            <span class="{($oDocument->member_srl?'member_'.$oDocument->member_srl:'bodex_0'.$oDocument->document_srl)}"{$_tmp_nick_color}>{$oDocument->nickName}</span>
                        </div>
                    </div>
                <!--@endif-->
            </div>

            <div class="dateAndCount">
                <!--@if(!$is_review)-->
                    <!--@if($module_info->use_vote == 'Y' || $module_info->use_vote == 'R')-->
                        <div class="votedCount">
                            {$lang->voted_count} : <strong>{$oDocument->voted_count} / {$oDocument->blamed_count}</strong>
                        </div>
                    <!--@elseif($module_info->use_vote == 'S' || $module_info->use_vote == 'Z')-->
                        {@ $average = number_format($oDocument->voted_count / abs($oDocument->blamed_count), 1)}
                        <div class="starPointFrame fr" title="{$average?$average:'0'}/{abs($oDocument->blamed_count)}">
                            <span class="starColor{$module_info->star_color} bodexBg1" style="width:{$average*15}px">&nbsp;</span>
                        </div>
                        <div class="votedCount average"><span>({$average?$average:'0'}/{abs($oDocument->blamed_count)})</span></div>
                    <!--@endif-->
                <!--@endif-->

                <div class="readedCount">{$lang->readed_count} : {$oDocument->readed_count}</div>

                <div class="date" title="{$lang->regdate}">
                    <strong>{$oDocument->getRegdate('Y.m.d')}</strong> ({$oDocument->getRegdate('H:i:s')})
                </div>

                <!--@if($oDocument->isSecret())--><img class="secret" src="./images/common/iconSecret.gif" border="0" title="{$lang->secret}" /><!--@endif-->

                <!--@if(count($writer_display_ccl))-->
                    {@
                        $ccl['attribution'] = in_array('attribution', $writer_display_ccl)?'yes':'no';
                        $ccl['commercial'] = in_array('commercial', $writer_display_ccl)?'yes':'no';
                        $ccl['derivatives'] = in_array('sharealike', $writer_display_ccl)?'alike':(in_array('derivatives', $writer_display_ccl)?'yes':'no');

                        $ccl['licenses'] = ($ccl['attribution']=='yes')?'by':'';
                        $ccl['licenses'] .= ($ccl['commercial']=='no')?'-nc':'';
                        $ccl['licenses'] .= ($ccl['derivatives']=='no')?'-nd':'';
                        $ccl['licenses'] .= ($ccl['derivatives']=='alike')?'-sa':'';
                    }
                    <!--@if($ccl['licenses'])-->
                    <div class="ccl">
                        <a href="#" onclick="winopen('http://creativecommons.org/licenses/{$ccl['licenses']}/3.0/deed.{$lang_type}','cclInfo','width=800, height=600, scrollbars=yes')">
                        <img src="./images/common/ccl_attribution_{$ccl['attribution']}.png" border="0" title="{$lang->ccl->attribution}: {Context::getLang('cmd_'.$ccl['attribution'])}" />
                        <img src="./images/common/ccl_commercial_{$ccl['commercial']}.png" border="0" title="{$lang->ccl->commercial}: {Context::getLang('cmd_'.$ccl['commercial'])}" />
                        <img src="./images/common/ccl_derivatives_{$ccl['derivatives']}.png" border="0" title="{$lang->ccl->derivatives}: {Context::getLang('cmd_'.$ccl['derivatives'])}" />
                        </a>
                    </div>
                    <!--@endif-->
                <!--@endif-->

                <!--@if($module_info->use_category != "N" && $oDocument->category_srl)-->
                    <div class="category" title="{$lang->category}">
                        <a href="{getUrl('category',$oDocument->category_srl, 'document_srl', '')}" <!--@if($category_list[$oDocument->category_srl]->color != 'transparent')-->style="color:{$category_list[$oDocument->category_srl]->color};"<!--@endif-->>{$category_list[$oDocument->category_srl]->title}</a>
                    </div>
                <!--@endif-->
            </div>
        </div>

        <div class="infoBox">
            <!--@if($is_review)-->
                <div class="xeSkinThumbnailFrame thumb <!--@if($module_info->thumbnail_position=='R')-->thumbfr<!--@endif-->" style="width:{$module_info->thumbnail_width+4}px;<!--@if($module_info->thumbnail_type!='ratio')-->height:{$module_info->thumbnail_height+4}px;<!--@endif-->">
                    <!--@if($oDocument->thumbnailExists($module_info->thumbnail_width, $module_info->thumbnail_height, $module_info->thumbnail_type))-->
                        <!--@if($module_info->thumbnail_navigation_button != 'N' && count($file_list['image']))-->
                            <img class="xeSkinThumbnailImage" rel="0" rev="{count($file_list['image'])}" src="{$oDocument->getThumbnail($module_info->thumbnail_width, $module_info->thumbnail_height, $module_info->thumbnail_type)}" border="0" alt="" />
                            <!--@if(count($file_list['image'])> 1)-->
                                <div class="xeSkinThumbControl" rel="{$module_info->thumbnail_type}">
                                    <a href="#" onclick="_xeSkinChangeThumbnail('prev'); return false"><img src="./images/common/arrowPrevD1.png" border="0" alt="Prev" width="22" height="22" /></a>
                                    <a href="#" onclick="_xeSkinChangeThumbnail('next'); return false"><img src="./images/common/arrowNextD1.png" border="0" alt="Next" width="22" height="22" /></a>
                                </div>
                            <!--@endif-->
                        <!--@else-->
                            <img src="{$oDocument->getThumbnail($module_info->thumbnail_width, $module_info->thumbnail_height, $module_info->thumbnail_type)}" border="0" alt="" />
                        <!--@endif-->
                    <!--@else-->
                        <img src="./images/common/noimg.png" border="0" alt="" class="thumb" width="{$module_info->thumbnail_width}" height="{$module_info->thumbnail_height}" />
                    <!--@endif-->
                </div>
            <!--@endif-->

            <div class="extraVarsList">

                <!--@if($is_review)-->
                    <a name="binaryfilelist"></a>
                    <div class="starRating">
                        <!--@if(in_array($module_info->display_download_button, array('Y','V')) && ((count($file_list['image']) && $is_display_image)||(count($file_list['media']) && $is_display_media)||(count($file_list['binary']) && $is_display_binary)))-->
                            <div class="fr">
                                <span class="button {$btn_class}"><input class="exSkinFileListButton" rel="{$oDocument->document_srl}" type="button" value="{htmlspecialchars($module_info->download_button_caption)}" /></span>
                            </div>
                        <!--@endif-->

                        <table cellspacing="0">
                        <!--@foreach($writer_rating_list as $val)-->
                            {@ $val->value = (float)$val->value}
                            <tr>
                                <th>{$val->name}:&nbsp;</th>
                                <td>
                                    <div class="starPointFrame" title="{$val->value}">
                                        <span class="starColor{$module_info->star_color} bodexBg1" style="width:{$val->value*15}px">&nbsp;</span>
                                    </div>
                                </td>
                            </tr>
                        <!--@endforeach-->
                        <!--@if($module_info->use_vote != 'N')-->
                            <tr>
                                <th>{$lang->user.' '.$lang->rating}:&nbsp;</th>
                                <td>
                                <!--@if($module_info->use_vote == 'Y' || $module_info->use_vote == 'R')-->
                                    <div class="votedCount">
                                        {$lang->voted_count} : <strong>{$oDocument->voted_count} / {$oDocument->blamed_count}</strong>
                                    </div>
                                <!--@elseif($module_info->use_vote == 'S' || $module_info->use_vote == 'Z')-->
                                    {@ $average = number_format($oDocument->voted_count / abs($oDocument->blamed_count), 1)}
                                    <div class="starPointFrame" title="{$average?$average:'0'}/{abs($oDocument->blamed_count)}">
                                        <div class="fl"><span class="starColor{$module_info->star_color} bodexBg1" style="width:{$average*15}px">&nbsp;</span></div>
                                        <span class="average">({$average?$average:'0'}/{abs($oDocument->blamed_count)})</span>
                                    </div>
                                <!--@endif-->
                                </td>
                            </tr>
                        <!--@endif-->
                        </table>
                    </div>
                <!--@endif-->

            <!--@if($oDocument->isExtraVarsExists())-->
                <table cellspacing="0" <!--@if(!$is_review)-->class="extraVarsTable"<!--@endif-->>
                    <!--@if(!$is_review)-->
                        <col width="150" />
                        <!--@foreach($writer_rating_list as $val)-->
                            <tr>
                                <th>{$val->name}:&nbsp;</th>
                                <td>
                                    <div class="starPointFrame" title="{$val->value}">
                                        <span class="starColor{$module_info->star_color} bodexBg1" style="width:{$val->value*15}px">&nbsp;</span>
                                    </div>
                                </td>
                            </tr>
                        <!--@endforeach-->
                    <!--@endif-->
                    <!--@foreach($extra_key_list as $key => $val)-->
                        <tr>
                            <th>{$val->name}:&nbsp;</th>
                            <td>{$val->getValueHTML()}&nbsp;</td>
                        </tr>
                    <!--@endforeach-->
                </table>
            <!--@endif-->

            </div>
        </div>

        <div class="readBody <!--@if($is_review)-->review<!--@endif-->">
            <div class="contentBody">

                <!--@if($module_info->document_top_text)-->
                    {preg_replace(array('/%MID%/','/%LOGIN%/','/%URL%/','/%TITLE%/','/%NAME%/','/%SRL%/'),array($module_info->module,($logged_info?$logged_info->nick_name:$lang->visitor),$oDocument->permanentUrl,$oDocument->title,$oDocument->nickName,$oDocument->document_srl),$module_info->document_top_text)}
                <!--@endif-->

                <!--@if($is_document_secret && !count($writer_appoint_ids))-->
                    <div class="secretContent">
                        <form action="./" method="get" onsubmit="return procFilter(this, input_password)">
                            <input type="hidden" name="mid" value="{$mid}" />
                            <input type="hidden" name="page" value="{$page}" />
                            <input type="hidden" name="document_srl" value="{$oDocument->document_srl}" />

                            <div class="title">{$lang->msg_is_secret}</div>
                            <div class="content">
                                <input type="password" name="password" id="cpw" class="userPw dStyle" />
                                <span class="button {$btn_class}">
                                    <input type="submit" value="{$lang->cmd_input}" accesskey="s" />
                                </span>
                            </div>
                        </form>
                    </div>
                <!--@else-->
                    <!--@if($grant->view && !$is_document_secret)-->
                        {$oDocument->getContent()}
                        <!--@if($is_logged && !$logged_user_voted_star && ($module_info->display_vote_button == 'A' || $module_info->display_vote_button == 'D'))-->
                            <div class="voteButton">
                                <a class="up" href="#" onclick="doCallModuleAction('document','procDocumentVoteUp','{$oDocument->document_srl}'); return false; ">{$lang->col_vote}</a>
                                <a class="down" href="#" onclick="doCallModuleAction('document','procDocumentVoteDown','{$oDocument->document_srl}'); return false; ">{$lang->col_blame}</a>
                            </div>
                        <!--@endif-->
                    <!--@else-->
                        {@$message=sprintf($lang->msg_act_not_permitted,$lang->col_read); $is_poped=1}
                        <!--#include("message.html")-->
                    <!--@endif-->
                <!--@endif-->

                <div class="clear"></div>

                <!--@if($module_info->document_bottom_text)-->
                    {preg_replace(array('/%MID%/','/%LOGIN%/','/%URL%/','/%TITLE%/','/%NAME%/','/%SRL%/'),array($module_info->module,($logged_info?$logged_info->nick_name:$lang->visitor),$oDocument->permanentUrl,$oDocument->title,$oDocument->nickName,$oDocument->document_srl),$module_info->document_bottom_text)}
                <!--@endif-->

                <!--// 서명 / 프로필 이미지 출력 -->
                <!--@if($module_info->display_sign != 'N' && $oDocument->member_srl && ($oDocument->profileImage || $oDocument->signature))-->
                    <div class="memberSignature">
                        <!--@if($module_info->display_sign != 'S' && $oDocument->profileImage)-->
                            <div class="profile">
                                <img src="{$oDocument->profileImage}" alt="profile" />
                            </div>
                        <!--@endif-->
                        <!--@if($oDocument->signature)-->
                            <div class="signature">{$oDocument->signature}</div>
                        <!--@endif-->
                    </div>
                <!--@endif-->

                <div class="docReadIpAndUrl">
                    <div class="docReadUri" title="{$lang->document_url}">
                        <a onclick="return doCopyClipboard(this.href);" href="{$oDocument->permanentUrl}">{$oDocument->permanentUrl}</a>
                    </div>
                    <div class="docReadIp">
                    <!--@if($grant->manager || $module_info->display_ip_address=='Y' || ($module_info->display_ip_address=='G'&&!$grant->manager))-->({$oDocument->getIpaddress()})<!--@endif-->
                    </div>
                </div>
            </div>

        </div>

        <a name="tagfilelist"></a>

        {@ $tag_list = $oDocument->get('tag_list') }
        <!--@if(count($tag_list))-->
        <div class="tag">
            <ul>
            <!--@for($i=0;$i<count($tag_list);$i++)-->
                {@ $tag = $tag_list[$i]; }
                <li>
                    <a href="{getUrl('search_target','tag','search_keyword',$tag,'document_srl','')}" rel="tag">{htmlspecialchars($tag)}</a><!--@if($i<count($tag_list)-1)-->,&nbsp;<!--@end-->
                </li>
            <!--@endfor-->
            </ul>
        </div>
        <!--@endif-->

        <!--@if(count($file_list['image']) || count($file_list['binary']) || count($file_list['media']))-->
            <!--@if(count($file_list['image']) && $is_display_image)-->
                <div class="<!--@if($is_review && in_array($module_info->display_download_button, array('Y','V')))-->displayHide<!--@else-->fileAttached<!--@endif--> exSkinImageListBox" rel="{$oDocument->document_srl}"><a name="imagefilelist"></a>
                    <ul>
                    {@ $downpoint = $idx = 0}
                    <!--@foreach($file_list['image'] as $file)-->
                        <!--@if($module_info->use_down_point_images=='Y')-->
                            {@ $downpoint = (!$file->file_size)?0:(($downloaded_list[$file->file_srl]>0 || ($file->member_srl == $logged_info->member_srl))?'0':$adopted_reward_point)}
                        <!--@endif-->
                        <li style="background-image:url('{$tpl_path}images/{$module_info->colorset}/{$file->isvalid=='Y'?'iconImage':'iconError'}.gif')">
                            <a <!--@if(preg_match("/\.(png|jpg|jpeg|bmp|gif|ico)$/i", $file->source_filename))-->class="exSkinImageSrc" rel="{$idx++}"<!--@endif--> href="{getUrl('').$file->download_url}" {(!$file->file_size)?'target="_bodexLink"':''} onclick="return {$file->isvalid=='Y'?(($module_info->download_point_confirm=='Y')?'_exSkinDownloadConfirm(\''.$downpoint.'\')':'true'):'false'}">
                                <span {$file->isvalid=='Y'?($downloaded_list[$file->file_srl]>0?'class="fileDownloaded"':''):'class="fileError" title="invalid"'}>{$file->source_filename}({($file->file_size)?FileHandler::filesize($file->file_size):'link'})[{number_format($file->download_count)}]{($downpoint > 0)?'($'.($downpoint).')':''}</span>
                            </a>
                        </li>
                    <!--@endforeach-->
                    </ul>
                </div>
            <!--@elseif($is_review && $module_info->thumbnail_navigation_button != 'N' && count($file_list['image']))-->
                <!--// 이미지 목록 출력이 아니면 리뷰일때 썸네일 이동을 위해 필요하므로 따로 숨겨놓음 -->
                <div class="displayHide exSkinThumbListBox">
                    {@ $idx = 0}
                    <!--@foreach($file_list['image'] as $file)-->
                        <a <!--@if(preg_match("/\.(png|jpg|jpeg|bmp|gif|ico)$/i", $file->source_filename))-->class="exSkinImageSrc" rel="{$idx++}"<!--@endif--> href="{getUrl('').$file->download_url}" onclick="return false"></a>
                    <!--@endforeach-->
                </div>
            <!--@endif-->

            <!--@if(count($file_list['media']) && $is_display_media)-->
                <div class="<!--@if($is_review && in_array($module_info->display_download_button, array('Y','V')))-->displayHide<!--@else-->fileAttached<!--@endif--> exSkinMediaListBox" rel="{$oDocument->document_srl}"><a name="mediafilelist"></a>
                    <ul>
                    {@ $downpoint = 0}
                    <!--@foreach($file_list['media'] as $file)-->
                        <!--@if($module_info->use_down_point_medias=='Y')-->
                            {@ $downpoint = (!$file->file_size)?0:(($downloaded_list[$file->file_srl]>0 || ($file->member_srl == $logged_info->member_srl))?'0':$adopted_reward_point)}
                        <!--@endif-->
                        <li style="background-image:url('{$tpl_path}images/{$module_info->colorset}/{$file->isvalid=='Y'?'iconMedia':'iconError'}.gif')">
                            <!--@if($is_review == 'review' || $module_info->use_media_player=='Y')-->
                                <a href="#" onclick="{$file->isvalid=='Y'?'popupDisplayMedia(\''.$file->file_srl.'\',\''.$file->sid.'\');':''} return false">
                            <!--@else-->
                                <a href="{getUrl('').$file->download_url}" {(!$file->file_size)?'target="_bodexLink"':''} onclick="return {$file->isvalid=='Y'?(($module_info->download_point_confirm=='Y')?'_exSkinDownloadConfirm(\''.$downpoint.'\')':'true'):'false'}">
                            <!--@endif-->
                                <span {$file->isvalid=='Y'?($downloaded_list[$file->file_srl]>0?'class="fileDownloaded"':''):'class="fileError" title="invalid"'}>{$file->source_filename}({($file->file_size)?FileHandler::filesize($file->file_size):'link'})[{number_format($file->download_count)}]{($downpoint > 0)?'($'.($downpoint).')':''}</span>
                            </a>
                        </li>
                    <!--@endforeach-->
                    </ul>
                </div>
            <!--@endif-->

            <!--@if(count($file_list['binary']) && $is_display_binary)-->
                <div class="<!--@if($is_review && in_array($module_info->display_download_button, array('Y','V')))-->displayHide<!--@else-->fileAttached<!--@endif--> exSkinFileListBox" rel="{$oDocument->document_srl}"><a name="binaryfilelist"></a>
                    <ul>
                    {@ $downpoint = 0}
                    <!--@foreach($file_list['binary'] as $file)-->
                        {@
                            $downpoint = (($downloaded_list[$file->file_srl]>0)?'0':$adopted_reward_point);
                            $downpoint = (!$file->file_size)?0:(($file->member_srl == $logged_info->member_srl)?'0':$downpoint+$download_file_point);
                        }
                        <li style="background-image:url('{$tpl_path}images/{$module_info->colorset}/{$file->isvalid=='Y'?($file->direct_download =='M'?'iconMedia':'iconFile'):'iconError'}.gif')">
                            <a href="{getUrl('').$file->download_url}" {(!$file->file_size)?'target="_bodexLink"':''} onclick="return {$file->isvalid=='Y'?(($module_info->download_point_confirm=='Y')?'_exSkinDownloadConfirm(\''.$downpoint.'\')':'true'):'false'}">
                                <span {$file->isvalid=='Y'?($downloaded_list[$file->file_srl]>0?'class="fileDownloaded"':''):'class="fileError" title="invalid"'}>{$file->source_filename}({($file->file_size)?FileHandler::filesize($file->file_size):'link'})[{number_format($file->download_count)}]{($downpoint >0)?'($'.($downpoint).')':''}</span>
                            </a>
                        </li>
                    <!--@endforeach-->
                    </ul>
                </div>
            <!--@endif-->
        <!--@endif-->
    </div>

    <div class="contentButton">
        <!--// 댓글,엮인글 버튼 -->
        <div class="replyAndTrackback">
            <!--@if($oDocument->allowComment()) -->
                <div class="replyCount">
                    <a class="exSkinReTrToggle" href="#" rel="Comment" rev="{$blog_style_doc_no}" onclick="return false;">
                        <strong>{$lang->comment}</strong>
                        <span class="replies">[{$oDocument->getCommentcount()}]</span>
                    </a>
                </div>
            <!--@endif-->
            <!--@if($oDocument->allowTrackback())-->
                <div class="trackbackCount">
                    <a class="exSkinReTrToggle" href="#" rel="Trackback" rev="{$blog_style_doc_no}" onclick="return false;">
                        <strong>{$lang->trackback}</strong>
                        <span class="trackbacks">({$oDocument->getTrackbackCount()})</span>
                    </a>
                </div>
            <!--@endif-->
        </div>

        <!--// 버튼이 없으면 위, 아래가 붙는거 방지 -->
        <span class="button" style="background-image:none;">&nbsp;</span>

        <!--@if(!$oDocument->isNotice()&&$grant->manager&&$module_info->use_doc_state=="Y")-->
            <select name="doc_state" class="doc_state dStyle">
                <!--@foreach($doc_state_list as $key=>$val)-->
                <option value="{$key}" <!--@if($oDocument->is_notice==$key)-->selected="selected"<!--@endif-->>{strip_tags($val)}</option>
                <!--@endforeach-->
            </select>
            <a href="#" onclick="doChangeDocumentState('{$oDocument->document_srl}',document.getElementsByName('doc_state')[0].value); return false;" class="button {$btn_class}">
                <span>{$lang->cmd_change_state}</span>
            </a>
        <!--@endif-->

        <!--// 채택된 답변이 있으면 -->
        <!--@if(($module_info->use_reward == 'Y' || $module_info->use_reward == 'R') && $oDocument->reward_point > 0 && $oDocument->reward_srl > 0)-->
            <a href="{getUrl('document_srl',$oDocument->document_srl,'comment_srl',$oDocument->reward_srl)}#comment_{$oDocument->reward_srl}" class="button {$btn_class}">
                <span>{$lang->cmd_adopted_comment_view}</span>
            </a>
        <!--@endif-->

        <!--@if($module_info->use_history == 'Y' || $module_info->use_history == 'Trace')-->
            <a href="{getUrl('document_srl',$oDocument->document_srl,'act','dispBoardHistoryList')}#history" class="button {$btn_class}">
                <span>{$lang->cmd_history_all}</span>
            </a>
        <!--@endif-->

        <!--// 블러그가 아니거나 블러그인데 문서번호가 있으면 목록버튼 출력 -->
        <!--@if(!$blog_style_doc_no || ($blog_style_doc_no && Context::get('document_srl')))-->
            <a href="{getUrl('act','','document_srl','','comment_srl','','rnd','')}" class="button {$btn_class}">
                <span><!--@if($blog_style_doc_no)-->{$lang->cmd_view_all}<!--@else-->{$lang->cmd_list}<!--@endif--></span>
            </a>
        <!--@endif-->

        <!--@if($oDocument->isEditable())-->
            <!--// 포인트 사용시 답글이 있으면 관리자외 수정 삭제 불가 단, 다운로드 포인트 제외-->
            {@ $is_disabled = (($module_info->use_reward == 'Y' && $oDocument->reward_point) || $module_info->use_reward == 'R') && $oDocument->comment_count > 0}

            <!--// 수정/삭제 버튼 -->
            <!--@if($grant->manager || !$is_disabled)-->
                <a href="{getUrl('act','dispBoardWrite','document_srl',$oDocument->document_srl,'comment_srl','')}" class="button {$btn_class}">
                    <span>{$lang->cmd_modify}</span>
                </a>
                <a href="{getUrl('act','dispBoardDelete','document_srl',$oDocument->document_srl,'comment_srl','')}" class="button {$btn_class}">
                    <span>{$lang->cmd_delete}</span>
                </a>
            <!--@endif-->
        <!--@endif-->
    </div>

    <!--// 댓글, 트랙백 펼쳐 보일지 지정, 댓글 감추기시 처음에 displayHide 쓰면 플래시 먹통됨 exSkinDisplayHideEx 사용 -->
    {@ $__display_comment = $__display_trackback = ''}
    <!--@if((!$cpage && !$rnd && !$comment_srl) || ($blog_style_doc_no))-->
        <!--@if($module_info->display_comment_box == 'C')-->
        {@ $__display_trackback = 'displayHide'}
        <!--@elseif($module_info->display_comment_box == 'T')-->
        {@ $__display_comment = 'exSkinDisplayHideEx'}
        <!--@elseif($module_info->display_comment_box == 'N')-->
        {@
            $__display_trackback = 'displayHide';
            $__display_comment =  'exSkinDisplayHideEx';
        }
        <!--@endif-->
    <!--@endif-->


    <!--// 엮인글 -->
    <!--@if($oDocument->allowTrackback())-->
        <a name="trackback{$blog_style_doc_no}"></a>
        <div class="exSkinTrackbackLayout {$__display_trackback}" rel="{$blog_style_doc_no}">
            <!--#include("./_view.trackback.html")-->
        </div>
    <!--@endif-->


    <!--// 댓글 -->
    <!--@if($oDocument->allowComment())-->
    <a name="comment{$blog_style_doc_no}"></a>
    <div class="exSkinCommentLayout {$__display_comment}" rel="{$blog_style_doc_no}">
    <!--@if($oDocument->getCommentCount()>0)--><!--#include("./_view.comment.html")--><!--@endif-->
        <!--// 댓글 입력 폼 -->
        <a name="comment_form"></a>
        <!--@if($grant->write_comment && $oDocument->isEnableComment() )-->
            {@ $form_include = true}
            <!--#include("./comment_form.html")-->
        <!--@endif-->
    </div>
    <!--@endif-->


</div>


