<!--@if($grant->write_document)-->
    <!--%import("../../tpl/filter/insert.xml")-->

    <!--// 게시물 작성 폼 -->
    <form action="./" method="post" onsubmit="return procFilter(this, insert)" id="fo_write">
    <input type="hidden" name="mid" value="{$mid}" />
    <input type="hidden" name="document_srl" value="" />

        <div class="bodexWrite">
            <!--@if(!$is_logged)-->
            <div class="writerInfo">
                <label for="userName">{$lang->writer}</label>
                <input type="text" name="nick_name" value="" class="userName dStyle" id="userName"/>

                <label for="userPw">{$lang->password}</label>
                <input type="password" name="password" value="" id="userPw" class="userPw dStyle" />

                <label for="emailAddress">{$lang->email_address}</label>
                <input type="text" name="email_address" value="" id="emailAddress" class="emailAddress dStyle"/>

                <label for="homePage">{$lang->homepage}</label>
                <input type="text" name="homepage" value="" id="homePage" class="homePage dStyle"/>
            </div>
            <!--@endif-->

            <div class="title">
                <!--@if($module_info->use_category!= "N")-->
                <select name="category_srl" class="category dStyle">
                    <option value="">{$lang->category}</option>
                    <!--@foreach($category_list as $val)-->
                        <!--@if($val->grant)-->
                            <option value="{$val->category_srl}" {($val->grant&&$val->selected)?'selected="selected"':''}>
                                {str_repeat("&nbsp;&nbsp;",$val->depth)} {$val->title} ({$val->document_count})
                            </option>
                        <!--@endif-->
                    <!--@endforeach-->
                </select>
                <!--@else-->
                <label class="title">{$lang->title}</label>
                <!--@endif-->
                <!--@if($module_info->document_default_title)-->
                    {@ $module_info->document_default_title = preg_replace(array('/%MID%/','/%LOGIN%/','/%URL%/'),array($module_info->module,($logged_info?$logged_info->nick_name:$lang->visitor),getFullUrl('','mid',$mid)),$module_info->document_default_title)}
                <!--@endif-->
                <input type="text" name="title" class="title dStyle" value="{$module_info->document_default_title?htmlspecialchars($module_info->document_default_title):''}" />
            </div>

            <dl class="option">
                <!--@if($grant->manager || $module_info->use_secret=="Y")-->
                <dd>
                    <input type="checkbox" name="is_secret" value="Y" {($module_info->use_secret=="R")?'checked="checked"':''} id="is_secret" />
                    <label for="is_secret">{$lang->secret}</label>
                </dd>
                <!--@elseif($module_info->use_secret=="R")-->
                    <input type="hidden" name="is_secret" value="Y" />
                <!--@endif-->
                <!--@if($is_logged)-->
                <dd>
                    <input type="checkbox" name="notify_message" value="Y" id="notify_message" />
                    <label for="notify_message">{$lang->notify}</label>
                </dd>
                <!--@endif-->
                <!--@if($grant->manager || $module_info->use_allow_comment=="Y")-->
                <dd>
                    <input type="checkbox" name="allow_comment" value="Y" {(($document_srl&&$oDocument->allowComment())||$module_info->use_allow_comment!="N")?'checked="checked"':''} id="allow_comment" />
                    <label for="allow_comment">{$lang->allow_comment}</label>
                </dd>
                <!--@else-->
                    <input type="hidden" name="allow_comment" value="Y" />
                <!--@endif-->
                <!--@if($grant->manager || $module_info->use_allow_trackback=="Y")-->
                <dd>
                    <input type="checkbox" name="allow_trackback" value="Y" {(($document_srl&&$oDocument->allowTrackback())||$module_info->use_allow_trackback!="N")?'checked="checked"':''} id="allow_trackback" />
                    <label for="allow_trackback">{$lang->allow_trackback}</label>
                </dd>
                <!--@else-->
                    <input type="hidden" name="allow_trackback" value="Y" />
                <!--@endif-->
            </dl>

            {@
                $oDocumentController = &getController('document');
                $oDocumentController->addXmlJsFilter($module_info->module_srl);
            }
            <!--@if(count($extra_keys))-->
                <table cellspacing="0" summary="" class="extraVarsList">
                <col width="150" />
                <col />
                <!--@foreach($extra_keys as $key => $val)-->
                    {@ $val->value = null}
                    <tr>
                        <th scope="row">{$val->name}{($val->is_required=='Y')?'*':''}</th>
                        <!--@if($val->eid=='writer_display_ccl')-->
                            <td><ul>
                                <li><input type="checkbox" value="attribution" name="extra_vars{$val->idx}" id="extra_vars_{$val->idx}_1" checked="checked" /><label for="extra_vars_{$val->idx}_1">{$lang->ccl->attribution}</label></li>
                                <li><input type="checkbox" value="commercial" name="extra_vars{$val->idx}" id="extra_vars_{$val->idx}_2" /><label for="extra_vars_{$val->idx}_2">{$lang->ccl->commercial}</label></li>
                                <li><input type="checkbox" value="derivatives" name="extra_vars{$val->idx}" id="extra_vars_{$val->idx}_3" /><label for="extra_vars_{$val->idx}_3">{$lang->ccl->derivatives}</label></li>
                                <li><input type="checkbox" value="sharealike" name="extra_vars{$val->idx}" id="extra_vars_{$val->idx}_4" checked="checked" /><label for="extra_vars_{$val->idx}_4">{$lang->ccl->sharealike}</label></li>
                                </ul><p>{$val->desc}</p>
                            </td>
                        <!--@elseif($val->eid=='writer_appoint_view')-->
                            <td>
                                {@ $grant_group_list = $oBodex->getGrantGroups($module_info->site_srl)}
                                <ul>
                                <!--@foreach($grant_group_list as $group_item)-->
                                    <li><input type="checkbox" value="#{$group_item->group_srl}" name="extra_vars{$val->idx}" id="extra_vars_{$val->idx}_{$group_item->group_srl}" /><label for="extra_vars_{$val->idx}_{$group_item->group_srl}">{$group_item->title}</label></li>
                                <!--@endforeach-->
                                </ul>
                                <input type="text" name="extra_vars{$val->idx}" value="" class="text">
                                <p>{$val->desc}</p>
                            </td>
                        <!--@else-->
                            <td>{$val->getFormHTML()}</td>
                        <!--@endif-->
                    </tr>
                <!--@endforeach-->
                </table>
            <!--@endif-->

            <!--@if($module_info->display_content_writer!="N")-->
                <!--@if($module_info->document_default_text)-->
                    {@ $module_info->document_default_text = preg_replace(array('/%MID%/','/%LOGIN%/','/%URL%/'),array($module_info->module,($logged_info?$logged_info->nick_name:$lang->visitor),getFullUrl('','mid',$mid)),$module_info->document_default_text)}
                <!--@endif-->
                <input type="hidden" name="content" value="{$module_info->document_default_text?htmlspecialchars($module_info->document_default_text):''}" />
                <div class="editor">{$oDocument->getEditor()}</div>
            <!--@endif-->

            <!--@if($module_info->display_tag_input!='N')-->
                <div class="tag">
                    <input type="text" name="tags" class="dStyle" value="{htmlspecialchars($oDocument->get('tags'))}" />
                    <a class="button {$btn_class}" title="{$lang->cmd_get_tags}" onclick="popupTagList(); return false;">
                    <span><img src="./images/common/iconAllTags.gif" border="0" /></span>
                    </a>
                    <p class="info">{$lang->about_tag}</p>
                </div>
            <!--@endif-->
        </div>

        <div class="fl gap1">
            <!--@if($is_logged)-->
            <span class="button {$btn_class}"><input type="button" value="{$lang->cmd_temp_save}"  onclick="doDocumentSave(this); return false;" /></span>
            <span class="button {$btn_class}"><input type="button" value="{$lang->cmd_load}"  onclick="doDocumentLoad(this); return false;" /></span>
            <!--@endif-->
            <span class="button {$btn_class}"><input type="button" value="{$lang->cmd_preview}" onclick="doDocumentPreview(this); return false;" /></span>
        </div>

        <div class="fr gap1">
            <span class="button {$btn_class}"><input type="submit" value="{$lang->cmd_registration}" accesskey="s" /></span>
        </div>
    </form>

<!--@else-->

    <!--@if($is_logged)-->
        <a href="#" onclick="return false" class="button {$btn_class}"><span>{sprintf($lang->msg_act_not_permitted,$lang->cmd_write)}</span></a>
    <!--@else-->
        <!--@if($module_info->display_simple_writer == "S")-->
            <script>var login_url = "{getUrl('','mid',$mid,'act','dispMemberLoginForm')}";location.href=login_url.replace(/&amp;/g,'&');</script>
        <!--@else-->
            <a href="{getUrl('','mid',$mid,'act','dispMemberLoginForm')}" class="button {$btn_class}"><span>{$lang->msg_please_login}</span></a>
        <!--@endif-->
    <!--@endif-->
<!--@endif-->
<div class="clear"></div>
