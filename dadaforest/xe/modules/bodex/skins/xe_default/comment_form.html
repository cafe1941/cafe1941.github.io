<!--@if(!$form_include)--><!--#include("__header.html")--><!--@endif-->

<!--@if($iframe_include)-->
<style type="text/css">body {border:0;margin:1px;padding:1px}</style>
<!--@endif-->

<!--@if(!$iframe_include && $oSourceComment && $oSourceComment->isExists())-->
    <!--// 만약 댓글의 답을 다는 것이라면 원문 보여줌 -->
    <div class="replyBox">
        <div class="replyItem">
            {@
                $oSourceComment->nickName = $oSourceComment->getNickName();
                $oSourceComment->member_srl = $oSourceComment->getMemberSrl();
                $oSourceComment->nickName = ($oSourceComment->nickName=='anonymous'?$lang->anonymous:$oSourceComment->nickName);
                $oSourceComment->member_srl = (!$grant->manager && $oSourceComment->member_srl && $oSourceComment->get('user_id')=='anonymous')?0:$oSourceComment->member_srl;
            }
            <div class="author"><div class="member_{$oSourceComment->member_srl}">{$oSourceComment->nickName}</div></div>
            <div class="date">
                {$oSourceComment->getRegdate("Y.m.d H:i")}
                <!--@if($grant->manager)-->
                    ({$oSourceComment->get('ipaddress')})
                <!--@endif-->
            </div>
            <div class="clear"></div>

            <div class="replyContent gap1">
                {$oSourceComment->getContent(false)}
            </div>
        </div>
    </div>
<!--@endif-->

    <!--// 글쓰기 폼 !$oComment 에러 방지 -->
<!--@if($oComment)-->
    {@
        $oComment = $oBodex->getWith($oComment, array('document_srl','parent_srl','comment_srl','member_srl','user_id','nick_name','email_address','homepage','content'));

        $oComment->email_address = htmlspecialchars($oComment->email_address);
        $oComment->homepage = htmlspecialchars($oComment->homepage);
        $oComment->content = htmlspecialchars($oComment->content);

        $oComment->is_secret = $oComment->isSecret();
        $oComment->use_notify = $oComment->useNotify();
    }
<!--@endif-->
    <form action="./" method="post" onsubmit="return procFilter(this, insert_comment)" class="bodexEditor" >
        <input type="hidden" name="mid" value="{$mid}" />
        <input type="hidden" name="document_srl" value="{($oComment)?$oComment->document_srl:$oDocument->document_srl}" />
        <input type="hidden" name="comment_srl" value="{$oComment->comment_srl}" />
        <input type="hidden" name="content" value="{$oComment->content}" />
        <input type="hidden" name="parent_srl" value="{$oComment->parent_srl}" />

        <div class="bodexWrite commentWrite <!--@if($iframe_include)-->iframe_include<!--@endif-->">
            <div class="writerInfo">

                <!--@if(!$oComment)-->
                    <!--@if(!$is_logged || $module_info->use_vote == 'N' || ($module_info->display_review_comment != 'Y' && $oDocument->member_srl == $logged_info->member_srl))-->
                        <input type="hidden" name="vote_point" value="0" />
                    <!--@else-->
                        <div class="votePoint">
                        <!--@if($logged_user_voted_star && $logged_user_voted_star != 0)-->
                            <!--@if($module_info->use_vote == 'S' || $module_info->use_vote == 'Z')-->
                                <div class="starPointFrame fl" title="{sprintf($lang->msg_acted_current_document,$lang->cmd_vote)}">
                                    <span class="starColor{$module_info->star_color} bodexBg1" style="width:{$logged_user_voted_star*15}px">&nbsp;</span>
                                </div>
                            <!--@else-->
                                <div class="fl">{sprintf($lang->msg_acted_current_document,($logged_user_voted_star < 0? $lang->cmd_vote_down:$lang->cmd_vote))}</div>
                            <!--@endif-->
                            <!--@if($module_info->use_vote_empty == 'Y')-->
                                <div class="voteEmpty">
                                    <a href="#" onclick="doCallModuleAction('{$module_info->module}','procBoardVoteEmpty','{$oDocument->document_srl}'); return false; " title="{$lang->cmd_vote_empty}"><span>{$lang->cmd_vote_empty}</span></a>
                                </div>
                            <!--@endif-->
                        <!--@elseif($is_logged && $module_info->use_vote == 'Y')-->
                            <input type="hidden" name="vote_point" value="0" />
                            <a class="up" href="#" onclick="doCallModuleAction('document','procDocumentVoteUp','{$oDocument->document_srl}'); return false; ">{$lang->cmd_vote}</a>
                            <a class="down" href="#" onclick="doCallModuleAction('document','procDocumentVoteDown','{$oDocument->document_srl}'); return false; ">{$lang->cmd_vote_down}</a>
                        <!--@elseif($is_logged && $module_info->use_vote == 'R')-->
                            <input name="vote_point" value="1" id="votePoint_0" type="radio">
                            <label class="up" for="votePoint_0">{$lang->cmd_vote}</label>
                            <input name="vote_point" value="-1" id="votePoint_1" type="radio">
                            <label class="down" for="votePoint_1">{$lang->cmd_vote_down}</label>
                        <!--@elseif($is_logged && ($module_info->use_vote == 'S' || $module_info->use_vote == 'Z'))-->
                            <ul class="exSkinStarPointBox">
                            <li><input type="hidden" name="vote_point" value="{$module_info->use_vote == 'S'?'0':''}" rel="{$module_info->use_vote == 'S'?'0':''}" /></li>
                            <!--@for($i=1;$i<6;$i++)--><li><a href="#" onclick="return false;" rel="{$i}" col="{$module_info->star_color}">&nbsp;</a></li><!--@end-->
                            <!--@if($module_info->use_vote == 'S')-->
                                <li><a class="vote_cancel" href="#" onclick="return false;" rel="0" col="{$module_info->star_color}" title="{$lang->cancel}"><span>{$lang->cancel}</span></a></li>
                                <li><a class="vote_register" href="#" onclick="doDocumentRating(jQuery('input[name=vote_point]').val()); return false;" title="{$lang->rating}"><span>{$lang->rating}</span></a></li>
                            <!--@endif-->
                            </ul>
                        <!--@endif-->
                        </div>
                    <!--@endif-->
                <!--@endif-->

                <dl class="option">
                    <!--@if(!$is_logged)-->
                        <dd><label for="userName">{$lang->writer}</label>
                        <input class="userName dStyle" type="text" name="nick_name" value="{$oComment->nick_name}" id="userName"/></dd>
                        <dd><label for="userPw">{$lang->password}</label>
                        <input class="userPw dStyle" type="password" name="password" id="userPw" /></dd>
                        <dd><label for="emailAddress">{$lang->email_address}</label>
                        <input class="emailAddress dStyle" type="text" name="email_address" value="{$oComment->email_address}" id="emailAddress"/></dd>
                        <dd><label for="homePage">{$lang->homepage}</label>
                        <input class="homePage dStyle" type="text" name="homepage" value="{$oComment->homepage}" id="homePage"/></dd>
                        </dl><dl class="option">
                    <!--@elseif($module_info->use_anonymous_comment == 'Y')-->
                        <dd><input type="checkbox" name="is_anonymous" value="Y" {(($oComment->member_srl < 0 || $oComment->user_id == 'anonymous') && $oComment->nick_name == 'anonymous')?'checked="checked"':''} id="is_anonymous" />
                            <label for="is_anonymous">{$lang->anonymous}</label></dd>
                    <!--@endif-->
                    <!--@if($module_info->use_secret_comment=="Y")-->
                        <dd><input type="checkbox" name="is_secret" value="Y" {$oComment->is_secret?'checked="checked"':''} id="is_secret" />
                        <label for="is_secret">{$lang->secret}</label></dd>
                    <!--@elseif($module_info->use_secret_comment=="R")-->
                        <input type="hidden" name="is_secret" value="Y" />
                    <!--@endif-->
                    <dd><input type="checkbox" name="notify_message" value="Y" {$oComment->use_notify?'checked="checked"':''} id="notify_message" />
                    <label for="notify_message">{$lang->notify}</label></dd>

                    <!--@if(!$oComment)-->
                        <!--@if($module_info->use_reward != 'N' && $oDocument->reward_point > 0)-->
                            <dd class="rewardPoint">
                            <!--@if($module_info->use_reward == 'Y' || $module_info->use_reward == 'R')-->
                                <!--@if(!$oDocument->reward_srl)-->
                                    ({sprintf($lang->msg_reward_point_adopt, '<strong>'.$adopted_reward_point.'</strong>')})
                                <!--@endif-->
                            <!--@elseif($module_info->use_reward == 'D')-->
                                ({($module_info->use_down_point_always=='Y')?$lang->always:$lang->first} {sprintf($lang->msg_reward_point_download, '<strong>'.$adopted_reward_point.'</strong>'.($download_file_point>0?' + '.$lang->always.': <strong>'.$download_file_point.'</strong>':''))})
                                <!--@if($module_info->use_down_point_medias == 'Y' || $module_info->use_down_point_images == 'Y')-->
                                    ({sprintf($lang->msg_apply_with, (($module_info->use_down_point_medias == 'Y')?($lang->media.(($module_info->use_down_point_images == 'Y')?', ':'')):'').(($module_info->use_down_point_images == 'Y')?$lang->image:''))})
                                <!--@endif-->
                            <!--@endif-->
                            </dd>
                        <!--@endif-->
                    <!--@endif-->

                <dl>
            </div>

            <div class="editor">{($oComment)?$oComment->getEditor():$oDocument->getCommentEditor()}</div>

        </div>

        <div class="commentButton tRight">
            <!--@if($oComment)-->
                <span class="button {$btn_class}"><input type="button" value="{$lang->cmd_back}" onclick="<!--@if($iframe_include)-->_exSkinIframeClose({$oSourceComment->isExists()?$oComment->parent_srl:$oComment->comment_srl});<!--@else-->location.href='{getUrl('act','')}';<!--@endif--> return false;"/></span>
            <!--@endif-->
            <span class="button {$btn_class}"><input type="submit" value="{$lang->cmd_comment_registration}" accesskey="s" /></span>
        </div>
    </form>

<!--@if(!$form_include)--><!--#include("__footer.html")--><!--@endif-->
